# this is a test configuration

# global filter; messages must have at least this severity to pass:
minSeverity: Info

# global file rotation settings:
rotation:
  rpLogLimitBytes: 5000000
  rpKeepFilesNum:  10
  rpMaxAgeHours:   24

# these backends are initialized:
setupBackends:
  - AggregationBK
  - EKGViewBK
  - KatipBK

# if not indicated otherwise, then messages are passed to these backends:
defaultBackends:
  - KatipBK

# if wanted, the GUI is listening on this port:
# hasGUI: 18321

# if wanted, the EKG interface is listening on this port:
hasEKG: 12789

# here we set up outputs of logging in 'katip':
setupScribes:
  - scKind: StdoutSK
    scName: stdout
  - scKind: FileTextSK
    scName: "testlog"
    scPrivacy: ScPrivate
    scRotation:
      rpLogLimitBytes: 25000000
      rpKeepFilesNum:  3
      rpMaxAgeHours:   24

# if not indicated otherwise, then log output is directed to this:
defaultScribes:
  - - StdoutSK
    - stdout

# more options which can be passed as key-value pairs:
options:
  cfokey:
    value: "Release-1.0.0"
  mapMonitors: !
    '#aggregation.critproc.observable':
        - monitor: (mean >= (42))
        - actions:
          - 'CreateMessage "exceeded" "the observable has been too long too high!"'
          - 'AlterGlobalMinSeverity Info'
    chain.creation.block:
        - monitor: ((time > (23 s)) Or (time < (17 s)))
        - actions:
          - 'AlterMinSeverity "chain.creation" Debug'
  mapSeverity:
    iohk.startup: Debug
    iohk.background.process: Error
    iohk.testing.uncritical: Warning
  mapSubtrace:
    iohk.benchmarking:
      tag: ObservableTrace
      contents:
        - GhcRtsStats
        - MonotonicClock
    iohk.deadend:
      NoTrace
  mapBackends:
    iohk.interesting.value:
      - EKGViewBK
      - AggregationBK
  mapScribes:
    iohk.interesting.value:
      - "StdoutSK::stdout"
      - "FileTextSK::testlog"
    iohk.background.process:
        "FileTextSK::testlog"
  mapAggregatedkinds:
    iohk.interesting.value:
        "EwmaAK {alpha = 0.75}"
    iohk.background.process:
        "StatsAK"
